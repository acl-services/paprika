version: v1.0
name: Paprika Semaphore 2.0 CI
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu1804

blocks:
  - name: "üöÄ NPM Release"
    task:
      jobs:
      - name: "Releasing"
        commands:
          - yarn npm:release
  # - name: "üé© Yarn"
  #   task:
  #     jobs:
  #     - name: "Yarn & caching"
  #       commands:
  #         - checkout
  #         - cache restore node-modules-$SEMAPHORE_GIT_BRANCH
  #         - yarn install --frozen-lockfile
  #         - npx lerna bootstrap
  #         - cache store node-modules-$SEMAPHORE_GIT_BRANCH node_modules
  #         - cache store cypress-$SEMAPHORE_GIT_BRANCH ~/.cache/Cypress
  #
  # - name: "üíÖ Format"
  #   task:
  #     prologue:
  #       commands:
  #         - checkout
  #         - cache restore node-modules-$SEMAPHORE_GIT_BRANCH
  #     jobs:
  #       - name: Lint && prettier
  #         commands:
  #           - yarn add eslint-plugin-react-hooks -D -W
  #           - yarn lint && yarn prettier -- --list-different
  #
  # - name: "‚ôøÔ∏è Accessibility"
  #   task:
  #     prologue:
  #       commands:
  #         - checkout
  #         - cache restore node-modules-$SEMAPHORE_GIT_BRANCH
  #     jobs:
  #       - name: Axe test
  #         commands:
  #           - yarn test:a11y
  #
  # - name: "‚ö°Ô∏è Integration/Unit"
  #   task:
  #     prologue:
  #       commands:
  #         - checkout
  #         - cache restore node-modules-$SEMAPHORE_GIT_BRANCH
  #         - yarn install
  #     jobs:
  #       - name: JEST
  #         commands:
  #           - yarn test
  #
  # - name: "‚õ∞ E2E"
  #   task:
  #     prologue:
  #       commands:
  #         - checkout
  #         - sudo apt-get -y install xvfb libgtk2.0-0 libnotify-dev libgconf-2-4 libnss3 libxss1 libasound2
  #         - cache restore node-modules-$SEMAPHORE_GIT_BRANCH
  #         - cache restore cypress-$SEMAPHORE_GIT_BRANCH
  #     jobs:
  #       - name: Cypress
  #         commands:
  #           - npx lerna bootstrap
  #           - yarn cypress:ci
  #
  # - name: "üîé Visual Regression"
  #   task:
  #     prologue:
  #       commands:
  #         - checkout
  #         - cache restore node-modules-$SEMAPHORE_GIT_BRANCH
  #     jobs:
  #       - name: Screener
  #         commands:
  #           - npx lerna bootstrap
  #           - yarn storybook:build
  #           - yarn storybook:screener
